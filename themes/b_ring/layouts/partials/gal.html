{{ $permaLink := substr (relURL .Permalink) 0 -1 }}
{{ $isGhost := .Params.isGhost }}
{{ $mt := or .Params.mt "0" }}
{{ $mr := or .Params.mr "0" }}
{{ $mb := or .Params.mb "0" }}
{{ $ml := or .Params.ml "0" }}
{{ $margin := (printf "%srem %srem %srem %srem" $mt $mr $mb $ml ) }}

<div class="gallery-item">

  {{ range $m := first 1 (where .Params.photos "featured" "true") }}
    {{ $imageName := index $m "photo" }}
    {{ $splitted := (split $imageName "/") }}
    {{ $img := index $splitted (sub (len $splitted) 1) }}
    {{ $alt := index $m "alt" }}
    {{ $size := or (index $m "size") "md" }}
    {{ $thumbPath := (printf "/photos/gal/%s" $img) }}

    <div class="gallery-image">
    {{ if $isGhost }}
      <img class="lazy ghost-image" alt="{{ $alt }}" data-original="{{ $thumbPath }}"/>
    {{ else }}
      <a href="{{ $permaLink }}">
        <img class="lazy" alt="{{ $alt }}" data-original="{{ $thumbPath }}" style="margin: {{ $margin }};" />
      </a>
    {{ end }}
    </div>
  {{ end }}
</div>
